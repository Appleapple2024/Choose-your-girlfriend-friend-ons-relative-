<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>æ·˜æ±°å›¾ç‰‡æ¸¸æˆ</title>
<style>
  body { font-family: sans-serif; text-align: center; background: #f9f9f9; }
  img { max-width: 45%; margin: 1%; cursor: pointer; border: 3px solid #ccc; border-radius: 10px; }
  #winnerBanner { font-size: 2em; color: red; margin-top: 20px; display:none; }
  #status { margin: 20px; font-size: 1.2em; }
  #reviveBtn { display: none; margin: 10px auto; padding: 10px 20px; font-size: 1em; cursor: pointer; }
</style>
</head>
<body>
<h1>æ·˜æ±°å›¾ç‰‡æ¸¸æˆ</h1>
<div id="status">ç‚¹å‡»å›¾ç‰‡é€‰æ‹©ä½ å–œæ¬¢çš„</div>
<div>
  <img id="img1" src="" alt="">
  <img id="img2" src="" alt="">
</div>
<button id="reviveBtn">å¤æ´»ä¸€æ¬¡å¤±è´¥çš„å›¾ç‰‡</button>
<div id="winnerBanner"></div>

<script>
// ----------- é»˜è®¤å›¾ç‰‡æ•°ç»„ï¼ˆæ ¹ç›®å½•å•å¼ å›¾ç‰‡ï¼‰ -----------
const defaultImages = Array.from({length:70}, (_,i) =>
  `${String(i+1).padStart(3,"0")}.jpg`
);

// å½“å‰æ¯”èµ›æ± 
let pool = [...defaultImages];

// èƒœè€…æ± 
let winners = [];

// å½“å‰è¿èƒœè®¡æ•°
let streak = 0;

// å½“å‰ä¸¤å¼ å›¾ç‰‡
let currentPair = [];

// ä¸Šä¸€æ¬¡å¤±è´¥çš„å›¾ç‰‡ï¼ˆç”¨äºå¤æ´»ï¼‰
let lastLoser = null;

// æ˜¯å¦å¤æ´»æœºä¼šå·²ç”¨
let reviveUsed = false;

// é€‰æ‹©ä¸‹ä¸€å¯¹å›¾ç‰‡
function nextPair() {
  if(pool.length === 0 && winners.length === 1) {
    // å† å†›å‡ºç°
    showChampion(winners[0]);
    return;
  }

  if(pool.length === 0) {
    // æ± ç©ºäº†ï¼Œä½¿ç”¨èƒœè€…æ± ç»§ç»­
    pool = [...winners];
    winners = [];
  }

  if(pool.length === 1) {
    currentPair = [pool[0]];
    document.getElementById('img1').src = pool[0];
    document.getElementById('img2').style.display = 'none';
    document.getElementById('status').textContent = 'æœ€åä¸€å¼ ï¼Œç‚¹å‡»é€‰æ‹©èƒœè€…';
    return;
  } else {
    document.getElementById('img2').style.display = 'inline';
  }

  // éšæœºé€‰æ‹©ä¸¤å¼ 
  let idx1 = Math.floor(Math.random() * pool.length);
  let img1 = pool.splice(idx1,1)[0];
  let idx2 = Math.floor(Math.random() * pool.length);
  let img2 = pool.splice(idx2,1)[0];

  currentPair = [img1,img2];
  document.getElementById('img1').src = img1;
  document.getElementById('img2').src = img2;
  document.getElementById('status').textContent = `ç‚¹å‡»ä½ å–œæ¬¢çš„å›¾ç‰‡`;
}

// ç‚¹å‡»é€‰æ‹©
function selectImage(selectedIdx) {
  let winner = currentPair[selectedIdx];
  let loser = currentPair[1 - selectedIdx];

  winners.push(winner);
  streak++;
  lastLoser = loser;
  document.getElementById('status').textContent = `è¿èƒœ: ${streak}`;

  // æ˜¾ç¤ºå¤æ´»æŒ‰é’®ï¼ˆä»…ä¸€æ¬¡æœºä¼šï¼‰
  if(!reviveUsed && lastLoser) {
    document.getElementById('reviveBtn').style.display = 'inline';
  }

  nextPair();
}

// å¤æ´»
document.getElementById('reviveBtn').onclick = function() {
  if(lastLoser && !reviveUsed) {
    pool.push(lastLoser);
    reviveUsed = true;
    this.style.display = 'none';
    document.getElementById('status').textContent = `å¤æ´»æˆåŠŸï¼ç»§ç»­æ¸¸æˆï¼Œè¿èƒœ: ${streak}`;
  }
}

// æ˜¾ç¤ºå† å†›
function showChampion(img) {
  document.getElementById('img1').style.display = 'none';
  document.getElementById('img2').style.display = 'none';
  document.getElementById('status').style.display = 'none';
  document.getElementById('reviveBtn').style.display = 'none';

  const banner = document.getElementById('winnerBanner');
  banner.textContent = `å† å†›ç”Ÿå­˜æµ·æŠ¥ ğŸ‰`;
  banner.style.display = 'block';

  const champImg = document.createElement('img');
  champImg.src = img;
  champImg.style.maxWidth = '50%';
  champImg.style.border = '5px solid gold';
  champImg.style.borderRadius = '15px';
  banner.appendChild(document.createElement('br'));
  banner.appendChild(champImg);
}

// ç»‘å®šç‚¹å‡»
document.getElementById('img1').onclick = () => selectImage(0);
document.getElementById('img2').onclick = () => selectImage(1);

// åˆå§‹åŒ–
nextPair();
</script>
</body>
</html>
